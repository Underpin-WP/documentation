"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[500],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=r.createContext({}),c=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),f=i,m=u["".concat(o,".").concat(f)]||u[f]||d[f]||a;return n?r.createElement(m,s(s({ref:t},p),{},{components:n})):r.createElement(m,s({ref:t},p))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,s=new Array(a);s[0]=u;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:i,s[1]=l;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},1457:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const a={},s="List Filter",l={unversionedId:"reference/helpers/processors/list-filter",id:"reference/helpers/processors/list-filter",title:"List Filter",description:"A list filter makes it possible to filter items from an array of objects using a chain-able query syntax. This feature",source:"@site/docs/reference/helpers/processors/list-filter.md",sourceDirName:"reference/helpers/processors",slug:"/reference/helpers/processors/list-filter",permalink:"/reference/helpers/processors/list-filter",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Underpin",permalink:"/"},next:{title:"List Sorter",permalink:"/reference/helpers/processors/list-sorter"}},o={},c=[{value:"Action",id:"action",level:2},{value:"Filter Action",id:"filter-action",level:3},{value:"Find Action",id:"find-action",level:3},{value:"Operations",id:"operations",level:2},{value:"Numeric Operations",id:"numeric-operations",level:3},{value:"Instance Operations",id:"instance-operations",level:3},{value:"Key Operations",id:"key-operations",level:3},{value:"Value Operations",id:"value-operations",level:3},{value:"In, Not-In",id:"in-not-in",level:4},{value:"And",id:"and",level:4},{value:"Equals",id:"equals",level:4},{value:"Callback",id:"callback",level:3},{value:"Seeding",id:"seeding",level:2}],p={toc:c};function d(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"list-filter"},"List Filter"),(0,i.kt)("p",null,"A list filter makes it possible to filter items from an array of objects using a chain-able query syntax. This feature\nis built-into ",(0,i.kt)("a",{parentName:"p",href:"/reference/registries/object-registries"},"Object Registries")," via the ",(0,i.kt)("inlineCode",{parentName:"p"},"Object_Registry::query")," method,\nhowever it can also be used on raw arrays, as long as each item in the array has the same getters and setters you're\nfiltering by. This can be done using fully-qualified objects, or by simply converting arrays to objects, as shown below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use \\Underpin\\Helpers\\Processors\\List_Filter;\n\n$ice_cream_order_items = [\n  'item_1' => (object) [\n      'customer' => (object)['name' => 'Alex', 'id' => 1],\n      'scoops' => ['strawberry','chocolate'],\n      'cone' => 'waffle',\n      'price' => 629,\n      'toppings' => ['cheese-crackers']\n  ],\n  \n  'item_2' => (object) [\n      'customer' => (object)['name' => 'Devin', 'id' => 2],\n      'scoops' => ['chocolate'],\n      'cone' => 'chocolate_waffle',\n      'price' => 429,\n      'toppings' => ['sprinkles']\n  ],\n  \n  'item_3' => (object) [\n      'customer' => (object)['name' => 'Kate', 'id' => 3],\n      'scoops' => ['vanilla'],\n      'cone' => 'basic',\n      'price' => 429,\n      'toppings' => []\n  ],\n  \n  'item_4' => (object) [\n      'customer' => (object)['name' => 'Ben', 'id' => 4],\n      'scoops' => ['strawberry','chocolate', 'vanilla'], \n      'cone' => 'bowl',\n      'price' => 899,\n      'toppings' => ['sprinkles']\n  ],\n];\n")),(0,i.kt)("h2",{id:"action"},"Action"),(0,i.kt)("p",null,"An action applies the set of operations against the array, and provides a result in different ways based on the type of\naction made."),(0,i.kt)("h3",{id:"filter-action"},"Filter Action"),(0,i.kt)("p",null,"The filter action will return a filtered array of items, filtering the results based on the provided criteria in the\noperations chained before the call."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [1,2]\n$filtered = (new List_Filter($ice_cream_order_items))->less_than(600)->filter();\n")),(0,i.kt)("h3",{id:"find-action"},"Find Action"),(0,i.kt)("p",null,"The find action will return the first item found based on the provided criteria in the operations chained before the\ncall."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// Returns item 1 in the array above\n$filtered = (new List_Filter($ice_cream_order_items))->equals('customer.id', 2)->find();\n")),(0,i.kt)("h2",{id:"operations"},"Operations"),(0,i.kt)("p",null,"An operation is a single specification on how to filter the items in the array. Operations can be chained together, and\nwill set multiple operations against the filter."),(0,i.kt)("p",null,"Operations are not applied until either ",(0,i.kt)("inlineCode",{parentName:"p"},"filter")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"find")," is called, and the operations run in the order they're\ndeclared."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [1]\n$filtered = (new List_Filter($ice_cream_order_items))\n  ->greater_than('price',629)\n  ->less_than('price', 899)\n  ->in('toppings','sprinkles')\n  ->filter();\n")),(0,i.kt)("h3",{id:"numeric-operations"},"Numeric Operations"),(0,i.kt)("p",null,"It's possible to filter numbers based on their value using ",(0,i.kt)("inlineCode",{parentName:"p"},"less_than"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"greater_than"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"less_than_or_equal"),",\nand ",(0,i.kt)("inlineCode",{parentName:"p"},"greater_than_or_equal"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [1,2]\n$filtered = (new List_Filter($ice_cream_order_items))->less_than(600)->filter();\n// [1,2,3]\n$filtered = (new List_Filter($ice_cream_order_items))->greater_than(400)->filter();\n// [1,2,3]\n$filtered = (new List_Filter($ice_cream_order_items))->greater_than_or_equal(429)->filter();\n// [0,1,2]\n$filtered = (new List_Filter($ice_cream_order_items))->less_than_or_equal(429)->filter();\n")),(0,i.kt)("h3",{id:"instance-operations"},"Instance Operations"),(0,i.kt)("p",null,"It's possible to filter values based on their instance type. Naturally, this requires that the items in-question are an\nactual instance. These filters work with the class, as well as any class that they inherit."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"interface Content{}\n\ninterface Article{}\n\nclass Blog_Post implements Content, Article{\n  /*..*/\n}\n\nclass Micro_Post implements Content, Article{\n  /*..*/\n}\n\nclass Comment implements Content{\n  /*..*/\n}\n\n$posts = [new Blog_Post(),new Blog_Post(), new Micro_Post(), new Comment()];\n\n// [0,1]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->instance_of(Blog_Post::class);\n// [0,1,2]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->instance_of(Article::class);\n// [0,1,3]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->not_instance_of(Micro_Post::class); \n// [3]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->not_instance_of(Article::class); \n// [0,1,2]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->has_all_instances(Content::class, Article::class);\n// [2,3]\n$filtered = (new \\Underpin\\Helpers\\Processors\\List_Filter($posts))->has_any_instances(Micro_Post::class, Comment::class);   \n")),(0,i.kt)("h3",{id:"key-operations"},"Key Operations"),(0,i.kt)("p",null,"These filters work against the array key instead of the array value."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [1,2]\n$filtered = (new List_Filter($ice_cream_order_items))->key_in('item_2', 'item_3')->filter();\n// [0,3]\n$filtered = (new List_Filter($ice_cream_order_items))->key_not_in('item_2', 'item_3')->filter();\n")),(0,i.kt)("h3",{id:"value-operations"},"Value Operations"),(0,i.kt)("p",null,"Value operations work directly against the various property values on the objects inside the array. In order for any\nvalue operation to work, the property must either be ",(0,i.kt)("inlineCode",{parentName:"p"},"public")," (",(0,i.kt)("inlineCode",{parentName:"p"},"readonly")," is okay!), or has an associated getter method\ncalled ",(0,i.kt)("inlineCode",{parentName:"p"},"get_${property}")," where ",(0,i.kt)("inlineCode",{parentName:"p"},"${property}")," is the name of the property that must be fetched. The getter method takes\npriority over the property value, so if you have a getter and a public property, it will use the getter method."),(0,i.kt)("p",null,"All value operations support dot notation for fetching values nested in objects, and can work with both arrays of\nvalues, and single values."),(0,i.kt)("h4",{id:"in-not-in"},"In, Not-In"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"in")," will set the query to filter out items whose field any of the provided values. ",(0,i.kt)("inlineCode",{parentName:"p"},"not_in")," does the exact opposite."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [0,2]\n$filtered = (new List_Filter($ice_cream_order_items))->in('cone', 'basic','waffle')->filter();\n// [1,3]\n$filtered = (new List_Filter($ice_cream_order_items))->in('toppings', 'sprinkles')->filter();\n// [0,1,3]\n$filtered = (new List_Filter($ice_cream_order_items))->in('toppings', 'sprinkles', 'cheese-crackers')->filter();\n// [0,2]\n$filtered = (new List_Filter($ice_cream_order_items))->not_in('toppings', 'sprinkles')->filter();\n// [2]\n$filtered = (new List_Filter($ice_cream_order_items))->not_in('toppings', 'sprinkles', 'cheese-crackers')->filter();\n// [3]\n$filtered = (new List_Filter($ice_cream_order_items))->in('customer.name','Ben')->filter();\n")),(0,i.kt)("h4",{id:"and"},"And"),(0,i.kt)("p",null,"Sets the query to filter out items whose field has all the provided values."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [0,3]\n$filtered = (new List_Filter($ice_cream_order_items))->and('scoops', 'strawberry','chocolate')->filter();\n")),(0,i.kt)("h4",{id:"equals"},"Equals"),(0,i.kt)("p",null,"Sets the query to filter out items whose value is not identical to the provided value."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [1,2]\n$filtered = (new List_Filter($ice_cream_order_items))->and('price', 429)->filter();\n// [0]\n$filtered = (new List_Filter($ice_cream_order_items))->and('scoops', ['strawberry','chocolate'])->filter();\n")),(0,i.kt)("h3",{id:"callback"},"Callback"),(0,i.kt)("p",null,"If all-else fails, you can chain in a callback to filter items. The example below would filter out any item whose cone\ntype does not begin with the letter 'b':"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// [2,3]\n$filtered = (new List_Filter($ice_cream_order_items))\n    ->filter_from_callback('cone', fn(string $cone) => 0 === strpos($cone,'b'))\n    ->filter();\n")),(0,i.kt)("h2",{id:"seeding"},"Seeding"),(0,i.kt)("p",null,"The concrete ",(0,i.kt)("inlineCode",{parentName:"p"},"List_Filter")," class can be seeded directly, using an array. This can be done both with the enums, and\nwithout. The enum is the preferred method, but if you're confident that the input is accurate, you can technically use\nan array directly. This can be useful in scenarios such as directly querying a registry using a REST endpoint, or\nsomething like that."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use Underpin\\Enums\\Filter;\n\n// Using Enums\nList_Filter::seed($ice_cream_order_items, [\n    Filter::in->field('cone')            => ['waffle', 'chocolate_waffle'],\n    Filter::greater_than->field('price') => 429,\n])->filter()\n\n// Raw query\nList_Filter::seed($ice_cream_order_items, [\n    'cone__in'            => ['waffle', 'chocolate_waffle'],\n    'price__greater_than' => 429,\n])->filter()\n")))}d.isMDXComponent=!0}}]);